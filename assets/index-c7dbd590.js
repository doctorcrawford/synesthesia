import{j as t,r as f,R as _}from"./react-a75412e8.js";import{c as ee}from"./react-dom-245c7db0.js";import{B as te}from"./react-router-dom-165b27c9.js";import{A as ne,a as se,O as re,S as oe,M as $,b as k,P as ae,c as ie,d as ce,e as le,G as ue,f as de,W as pe,g as me,C as he,V as fe,h as ge}from"./three-911c03ca.js";import{g as F}from"./gsap-4db78ffb.js";import{B as ye,I as xe,a as we,b as je,c as be,d as ve,e as Se,f as Ne,g as Pe,h as Me}from"./react-icons-39483d42.js";import{a as Ae,b as Ce}from"./react-router-0a3f0538.js";import"./scheduler-765c72db.js";import"./@remix-run-2097ded9.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();function Le(){return t.jsx(t.Fragment,{children:t.jsx("h1",{className:"header-title",children:"Let's Dance"})})}function Ee(){return t.jsx(t.Fragment,{children:t.jsxs("nav",{children:[t.jsx("a",{href:"/",children:"Synesthesia"}),t.jsx("ul",{})]})})}function Ie(e,n){const s=new ne;e.add(s);const a=new se(s);a.autoplay=!0,a.setLoop(!0);const r=document.querySelector("audio"),i=n.createMediaElementSource(r),o=n.createAnalyser(),u=n.createGain(),l={pan:0},c=new StereoPannerNode(n,l);i.connect(u).connect(c).connect(o).connect(n.destination),o.fftSize=1024;const d=o.frequencyBinCount;return[new Uint8Array(d),u,c,o]}function Fe(e,n,s,a,r,i,o){var l;const u=n.geometry.attributes.position.count;for(let c=0;c<u;c++){const d=(l=n.geometry.boundingSphere)==null?void 0:l.radius,y=2,h=window.performance.now()/600,m=1e-6,w=n.geometry.attributes.uv.getX(c)*Math.PI*16,x=n.geometry.attributes.uv.getY(c)*Math.PI*16,A=n.geometry.attributes.uv.getZ(c)*Math.PI*16,C=w+h,P=Math.sin(C)*o,M=x+h,j=Math.cos(M)*o,v=c*3,p=c*3+1,b=c*3+2;if(d!==void 0){const S=d/36+r+e.noise3d(w+h*m*7,x+h*m*8,A+h*m*9)*y*i;n.geometry.attributes.position.setX(c,s[v]+a[v]*(S+P+j)),n.geometry.attributes.position.setY(c,s[p]+a[p]*(S+P+j)),n.geometry.attributes.position.setZ(c,s[b]+a[b]*(S+P+j))}}n.geometry.computeVertexNormals(),n.geometry.attributes.position.needsUpdate=!0}function Oe(e,n,s){const a=Date.now()/400,r=n.geometry.attributes.position.count,i=2;for(let o=0;o<r;o++){const u=n.geometry.attributes.position.getX(o),l=n.geometry.attributes.position.getY(o),c=Math.sin(u+a),d=Math.cos(l+a),y=(e.noise(u+a*3e-4,l+a*1e-4)+0)*s*i;n.geometry.attributes.position.setZ(o,y+c+d)}n.geometry.computeVertexNormals(),n.geometry.attributes.position.needsUpdate=!0}function ke(e,n,s){return(e-n)/(s-n)}function O(e,n,s,a,r){const i=ke(e,n,s),o=r-a;return a+i*o}function q(e){return e.reduce(function(s,a){return s+a})/e.length}function Ve(e){return e.reduce(function(n,s){return Math.max(n,s)})}function Be(e,n){const s=new re(e,n);return s.enableDamping=!0,s.enablePan=!1,s.enableZoom=!1,s.autoRotate=!0,s.autoRotateSpeed=1,s}function Te(e,n,s){window.addEventListener("resize",()=>{e.width=window.innerWidth,e.height=window.innerHeight,n.aspect=e.width/e.height,n.updateProjectionMatrix(),s.setSize(e.width,e.height)})}function Ge(){const e=new oe(10,256,128),n=new $({color:"#e6ffa8",wireframe:!0});return[new k(e,n),e]}function qe(){const e=new ae(800,800,60,60),n=new $({color:"#00ff83",wireframe:!0}),s=new k(e,n),a=new k(e,n);return[s,a,e]}function De(){const e=new ie(16777215,1,100);return e.intensity=5.9,e.position.set(-30,40,20),e.castShadow=!0,e}const D=new ce,$e=(e,n)=>{const s=new le,a=new ue,r={width:window.innerWidth,height:window.innerHeight},i=new de(45,r.width/r.height,.1,1e3),o=new pe;o.setClearColor(0),o.setSize(r.width,r.height),o.setPixelRatio(2),e.appendChild(o.domElement),i.position.set(0,0,100);const u=Be(i,e);Te(r,i,o);const[l,c,d,y]=Ie(i,n),[h,m]=Ge();a.add(h);const[w,x,A]=qe();w.rotation.x=.5*Math.PI,w.position.set(0,30,0),a.add(w),x.rotation.x=.5*Math.PI,x.position.set(0,-30,0),a.add(x);const C=De();C.lookAt(h.position),s.add(C);const P=new me(11184810);s.add(P);const M=document.querySelector("#volume");if(M)M.addEventListener("input",()=>{c.gain.value=parseFloat(M.value)},!1);else throw new Error("no volume control");const j=document.querySelector("#panner");if(j)j.addEventListener("input",()=>{d.pan.value=parseFloat(j.value)},!1);else throw new Error("no panner control");const v=F.timeline({defaults:{duration:1}}),p=F.timeline({defaults:{duration:3}});v.fromTo(h.scale,{z:0,x:0,y:0},{z:1,x:1,y:1}),p.fromTo("nav",{y:"-100%"},{y:"0%"}),p.fromTo(".header-title",{opacity:0},{opacity:1});let b=!1,S=[];window.addEventListener("mousedown",()=>b=!0),window.addEventListener("mouseup",()=>b=!1);const X=(g,N,E)=>"#"+[g,N,E].map(I=>I.toString(16).padStart(2,"0")).join("");window.addEventListener("mousemove",g=>{if(b){S=[Math.round(g.pageX/r.width*255),Math.round(g.pageY/r.height*255),175];const N=new he(X(S[0],S[1],S[2]));F.to(h.material.color,{r:N.r,g:N.g,b:N.b})}});const V=[],B=new fe,T=m.attributes.position;for(let g=0;g<T.count;g++)B.fromBufferAttribute(T,g).normalize(),V.push(B.clone());m.userData.nPosSphere=V;const W=new ge;s.add(a);const J=JSON.parse(JSON.stringify(m.attributes.position.array)),Y=JSON.parse(JSON.stringify(m.attributes.normal.array)),Z=.2,G=()=>{W.getElapsedTime(),y.getByteFrequencyData(l);const g=l.slice(0,l.length/2-1),N=l.slice(l.length/2-1,l.length-1),E=Ve(g),I=q(g),U=q(N),K=E/g.length,R=I/g.length,Q=U/N.length;Fe(D,h,J,Y,O(Math.pow(K,.8),0,1,0,8),O(Q,0,2,0,4),Z),Oe(D,w,O(R,0,1,.5,4)),A.computeVertexNormals(),A.attributes.position.needsUpdate=!0,u.update(),requestAnimationFrame(G),o.render(s,i)};G()},ze=({audioContext:e})=>{const[n,s]=f.useState(!1),a=f.useCallback(r=>{r!==null&&!n&&($e(r,e),s(!0))},[n]);return t.jsx("div",{className:"webgL",style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh"},ref:a})},z="/synesthesia/assets/radio-man-991508e8.mp3",He="/synesthesia/assets/radio-man-fb944eeb.png",Xe="/synesthesia/assets/ronnie-b-5dd809b9.mp3",We="/synesthesia/assets/ronnie-b-ec5191a5.jpg",L=[{title:"Radio Man ft. An",src:z,author:"KNXN ft. An",thumbnail:He},{title:"Ronnie B",src:Xe,author:"KNXN",thumbnail:We}],Je=({currentTrack:e,audioRef:n,setDuration:s,progressBarRef:a,handleNext:r})=>{const i=()=>{if(n.current&&a.current){const o=n.current.duration;s(o),a.current.max=o.toString()}};return t.jsxs("div",{children:[t.jsx("audio",{src:e.src,ref:n,onLoadedMetadata:i,onEnded:r}),t.jsxs("div",{className:"audio-info",children:[t.jsx("div",{className:"audio-image",children:e.thumbnail?t.jsx("img",{src:e.thumbnail,alt:"audio avatar"}):t.jsx("div",{className:"icon-wrapper",children:t.jsx("span",{className:"audio-icon",children:t.jsx(ye,{})})})}),t.jsxs("div",{className:"text",children:[t.jsx("p",{className:"title",children:e.title}),t.jsx("p",{children:e.author})]})]})]})},Ye=({audioRef:e,audioContext:n,progressBarRef:s,duration:a,setTimeProgress:r,tracks:i,trackIndex:o,setTrackIndex:u,setCurrentTrack:l,handleNext:c})=>{const[d,y]=f.useState(!1),h=f.useRef(0),[m,w]=f.useState(60),[x,A]=f.useState(!1);n.resume();const C=()=>{n.state==="suspended"&&n.resume(),y(p=>!p)},P=()=>{e.current&&(e.current.currentTime+=15)},M=()=>{e.current&&(e.current.currentTime-=15)},j=()=>{if(o===0){const p=i.length-1;u(p),l(i[p])}else u(o-1),l(i[o-1])},v=f.useCallback(()=>{var b;const p=(b=e.current)==null?void 0:b.currentTime;p&&s.current!==null&&(r(p),s.current.style.setProperty("--range-progress",`${p/a*100}%`)),h.current&&(h.current=requestAnimationFrame(v))},[e,a,s,r]);return f.useEffect(()=>{e.current&&(d?e.current.play():e.current.pause()),h.current=requestAnimationFrame(v)},[d,e,v]),f.useEffect(()=>{e.current&&(e.current.volume=m/100,e.current.muted=x)},[m,e,x]),t.jsxs("div",{className:"controls-wrapper",children:[t.jsxs("div",{className:"controls",children:[t.jsx("button",{onClick:j,children:t.jsx(xe,{})}),t.jsx("button",{onClick:M,children:t.jsx(we,{})}),t.jsx("button",{onClick:C,children:d?t.jsx(je,{}):t.jsx(be,{})}),t.jsx("button",{onClick:P,children:t.jsx(ve,{})}),t.jsx("button",{onClick:c,children:t.jsx(Se,{})})]}),t.jsxs("div",{className:"volume",children:[t.jsx("button",{onClick:()=>A(p=>!p),children:x||m<5?t.jsx(Ne,{}):m<40?t.jsx(Pe,{}):t.jsx(Me,{})}),t.jsx("input",{type:"range",min:0,max:100,value:m,onChange:p=>w(Number(p.target.value)),style:{background:`linear-gradient(to right, #f50 ${m}%, #ccc ${m}%)`}})]})]})},Ze=({progressBarRef:e,audioRef:n,timeProgress:s,duration:a})=>{const r=()=>{n.current&&e.current&&(n.current.currentTime=Number(e.current.value))},i=o=>{if(o&&!isNaN(o)){const u=Math.floor(o/60),l=u<10?`0${u}`:`${u}`,c=Math.floor(o%60),d=c<10?`0${c}`:`${c}`;return`${l}:${d}`}};return t.jsxs("div",{className:"progress",children:[t.jsx("span",{className:"time current",children:s?i(s):"00:00"}),t.jsx("input",{type:"range",ref:e,defaultValue:"0",value:s,onChange:r}),t.jsx("span",{className:"time",children:i(a)})]})};function Ue({audioContext:e}){const[n,s]=f.useState(0),[a,r]=f.useState(L[n]),[i,o]=f.useState(0),[u,l]=f.useState(0),c=f.useRef(null),d=f.useRef(null),y=()=>{n>=L.length-1?(s(0),r(L[0])):(s(n+1),r(L[n+1]))};return t.jsxs("div",{className:"audio-player",children:[t.jsxs("div",{className:"inner",children:[t.jsx(Je,{currentTrack:a,audioRef:c,setDuration:l,progressBarRef:d,handleNext:y}),t.jsx(Ye,{audioRef:c,audioContext:e,progressBarRef:d,duration:u,setTimeProgress:o,tracks:L,trackIndex:n,setTrackIndex:s,setCurrentTrack:r,handleNext:y}),t.jsx(Ze,{progressBarRef:d,audioRef:c,timeProgress:i,duration:u})]}),t.jsx("audio",{src:z}),t.jsxs("div",{id:"volume-panner",children:[t.jsx("label",{children:"Volume"}),t.jsx("input",{type:"range",id:"volume",min:"0",max:"2",defaultValue:"1",step:"0.01"}),t.jsx("label",{children:"Panner"}),t.jsx("input",{type:"range",id:"panner",min:"-1",max:"1",defaultValue:"0",step:"0.01"}),t.jsx("br",{})]})]})}function Ke(){const e=new window.AudioContext;return t.jsxs(t.Fragment,{children:[t.jsx(Ue,{audioContext:e}),t.jsx(ze,{audioContext:e})]})}function Re(){return t.jsx(t.Fragment,{children:t.jsxs(te,{children:[t.jsx(Ee,{}),t.jsx(Le,{}),t.jsx(Ae,{children:t.jsx(Ce,{path:"/synesthesia",element:t.jsx(Ke,{})})})]})})}const H=document.getElementById("root");if(H===null)throw new Error("Root container missing in index.html");const Qe=ee.createRoot(H);Qe.render(t.jsx(t.Fragment,{children:t.jsx(_.StrictMode,{children:t.jsx(Re,{})})}));
